<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>B·∫£ng qu·∫£n tr·ªã</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Arial',sans-serif;}
    body{background:#f5f5f5;color:#333;}
    .navbar{
      background:#2c3e50;color:white;padding:10px 20px;
      display:flex;justify-content:space-between;align-items:center;
      position:fixed;top:0;left:0;width:100%;z-index:10;
    }
    .sidebar{
      background:#34495e;color:white;width:250px;height:100vh;
      position:fixed;top:60px;left:0;padding-top:20px;
    }
    .sidebar ul{list-style:none;padding:0;}
    .sidebar ul li{border-bottom:1px solid #46627f;}
    .sidebar ul li a{
      display:flex;align-items:center;padding:12px 20px;
      color:white;text-decoration:none;transition:0.3s;
    }
    .sidebar ul li a:hover{background:#2c3e50;}
    .main-content{
      margin-left:250px;margin-top:60px;padding:20px;
      min-height:calc(100vh - 60px);
    }
    iframe{
      border:none;width:100%;height:calc(100vh - 120px);
      background:white;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <div class="navbar">
    <div><a href="dashboard.html"><img src="https://bknet.edu.vn/wp-content/uploads/2024/06/logo-bknet-2024.png" style="width:100px;"></a></div>
    <div id="user-info">üëã Xin ch√†o Admin...</div>
    <a href="/auth/logout" style="color:white;text-decoration:none;">ƒêƒÉng xu·∫•t</a>
  </div>

  <div class="sidebar">
    <ul>
      <li><a href="#" data-page="home"><i class="fas fa-home"></i> Trang ch·ªß</a></li>
      <li><a href="#" data-page="maps"><i class="fas fa-shopping-cart"></i> Qu·∫£n l√Ω B·∫£n ƒê·ªì</a></li>
      <li><a href="#" data-page="roles"><i class="fas fa-box"></i> Qu·∫£n l√Ω Roles</a></li>
      <li><a href="#" data-page="agents"><i class="fas fa-users"></i> Qu·∫£n l√Ω Agents</a></li>
      <li><a href="#" data-page="admin"><i class="fas fa-user-shield"></i> Qu·∫£n l√Ω Admin</a></li>
    </ul>
  </div>

  <div class="main-content">
    <div id="content-area">
      <h2>Ch√†o m·ª´ng b·∫°n ƒë·∫øn trang qu·∫£n tr·ªã!</h2>
      <p>Ch·ªçn m·ªôt m·ª•c ·ªü menu b√™n tr√°i ƒë·ªÉ b·∫Øt ƒë·∫ßu.</p>
    </div>
  </div>

  <script>
    // 1. Hi·ªÉn th·ªã t√™n admin t·ª´ session
    fetch("/api/me")
      .then(res => res.json())
      .then(user => {
        document.getElementById("user-info").innerHTML = `üëã Xin ch√†o <b>${user.username}</b>`;
      })
      .catch(() => {
        document.getElementById("user-info").innerHTML = "B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p.";
      });
    // üß≠ X·ª≠ l√Ω click menu
    document.querySelectorAll(".sidebar a").forEach(link => {
        link.addEventListener("click", e => {
          e.preventDefault();
          const page = e.target.closest("a").dataset.page;
          if (page === "home") {
            document.getElementById("content-area").innerHTML =
              "<h2>Trang ch·ªß</h2><p>Ch√†o m·ª´ng quay l·∫°i!</p>";
            return;
          }
          // Fetch trang con (VD: /pages/admin.html)
          fetch(`/pages/${page}`)
            .then(res => res.text())
            .then(html => {
              document.getElementById("content-area").innerHTML = html;
              // Sau khi load admin.html -> n·∫°p script
              if (page === "admin") {
                const script = document.createElement("script");
                script.src = "/js/admin/admin.js";
                document.body.appendChild(script);
              }
              if (page === "agents") {
                const script = document.createElement("script");
                script.src = "/js/agents/agents.js";
                document.body.appendChild(script);
              }
              if (page === "roles") {
                const script = document.createElement("script");
                script.src = "/js/agents/roles.js";
                document.body.appendChild(script);
              }
            })
            .catch(() => {
              document.getElementById("content-area").innerHTML =
                "<p style='color:red;'>L·ªói t·∫£i trang!</p>";
            });
        });
      });
  
  </script>
</body>
</html>
